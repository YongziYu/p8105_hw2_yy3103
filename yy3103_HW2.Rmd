---
title: "p8105_HW2"
author: "Yongzi Yu yy3103"
output: html_document
---

I'm an R Markdown document! 

# load packages
```{r}
library(tidyverse)
library(tidyr)
library(readxl)
library(Hmisc)
library(dplyr)
```
# Problem1

```{r}
trash_data= 
  read_excel("./data/trash.xlsx",skip=1,sheet=1)%>%
  janitor::clean_names() %>%
  select(dumpster:homes_powered)%>%
  drop_na(dumpster)%>%
  mutate(sports_balls=round(sports_balls))

pre_2019=
  read_excel("./data/trash.xlsx",skip=1,sheet=4)%>%
  janitor::clean_names() %>%
  drop_na()%>%
  mutate(year=2019)

pre_2018=
  read_excel("./data/trash.xlsx",skip=1,sheet=5)%>%
  janitor::clean_names() %>%
  drop_na()%>%
  mutate(year=2018)

pre_1819=
  full_join(pre_2018,pre_2019) %>%
  mutate(month=month.name[month])

sum(pre_1819$total)
```

- For Mr.Trash Wheel Sheet, there are `r nrow(trash_data)` rows and `r ncol(trash_data)` columns.    Key variables are `r colnames(trash_data)`.  
- For precipitation, there are `r nrow(pre_1819)` rows and `r ncol(pre_1819)` columns.  
Key variables are `r colnames(trash_data)`.  Total precipitation in 2018 is `r sum(pull(pre_2018,total))`.  Median number of sports balls in a dumpster in 2017 is `r median(pull(filter(trash_data,year=="2019"),sports_balls))`.

# Problem2
```{r}
pols= 
  read_csv("./data/pols_month.csv") %>%
  separate(mon, c("year", "month","day"), sep="-") %>% #separate value
  mutate(month=month.name[(as.double(month))]) %>% #change month
  mutate(president=prez_gop+prez_dem) %>% #add variable
  select(-prez_gop,-prez_dem,-day) %>% #remove col 
  mutate(key=paste(as.character(year),as.character(month)))

snp=
  read_csv("./data/snp.csv")%>%
  separate(date, c("month","day","year"), sep="/") %>% #separate value
  mutate(month=month.name[(as.double(month))]) %>% #change month
  arrange(year,month)%>%
mutate(key=paste(as.character(year),as.character(month)))

unemployment=
  read_csv("./data/unemployment.csv")%>%
  pivot_longer(
    Jan:Dec,
    names_to = "month", 
    values_to = "unemployment_rate")%>%
  mutate(key=paste(as.character(Year),as.character(month)))

#join
pols_snp=
  left_join(pols,snp,by='key')

pols_snp_unempl=
  left_join(pols_snp,unemployment,by='key')
```

- For pols, there are `r nrow(pols)` rows and `r ncol(pols)` columns in the joined data set.Key variables are `r colnames(pols)`.  
-For snp, there are `r nrow(snp)` rows and `r ncol(snp)` columns in the joined data set.Key variables are `r colnames(snp)`. 
-For unemployment, there are `r nrow(unemployment)` rows and `r ncol(unemployment)` columns in the joined data set.Key variables are `r colnames(unemployment)`. 
- there are `r nrow(pols_snp_unempl)` rows and `r ncol(pols_snp_unempl)` columns in the joined data set.Key variables are `r colnames(pols_snp_unempl)`.  

# Problem 3
```{r}
names= 
  read_csv("./data/Popular_Baby_Names.csv")

#remove duplicates
names=
  names[!duplicated(names), ]
names=
  names %>%
  janitor::clean_names() %>%
  mutate(childs_first_name=capitalize(str_to_lower(childs_first_name)))

#show most popular name in female over time
Olivia=
  names %>% 
  filter(gender == "FEMALE")%>% 
  filter(childs_first_name == "Olivia")%>% 
  select(ethnicity,everything(),-gender,-count,-childs_first_name)%>% 
  pivot_wider(
    ethnicity:rank,
    names_from= "year_of_birth",
    values_from= "rank"
  )

#show most popular name in male over time
Male=
  names %>% 
  filter(gender == "MALE")%>% 
  filter(rank == "1")%>% 
  select(ethnicity,childs_first_name,everything(),-gender,-count,-rank)%>% 
  pivot_wider(
    ethnicity:childs_first_name,
    names_from= "year_of_birth",
    values_from= "childs_first_name"
  )
#draw plot
names_plot = 
  names %>% 
  janitor::clean_names() %>% 
  filter(year_of_birth=='2016') %>% 
  filter(gender=='MALE') %>% 
  filter(ethnicity == 'WHITE NON HISPANIC')


ggplot(names_plot,aes(y=rank,x=count))+geom_point()
```

